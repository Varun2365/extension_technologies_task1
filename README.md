# ğŸ“± Employee Attendance & Leave Management System

> **Note:** This README has been generated by AI.

A full-stack application for managing employee attendance, leave applications, and tracking work hours. Built with **Node.js/Express** backend and **Flutter** mobile frontend.

![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)
![Express](https://img.shields.io/badge/Express-5.2-blue.svg)
![MongoDB](https://img.shields.io/badge/MongoDB-7.0-brightgreen.svg)
![Flutter](https://img.shields.io/badge/Flutter-3.6-blue.svg)
![JWT](https://img.shields.io/badge/JWT-Auth-orange.svg)

## ğŸŒ Live Server

**API Base URL:** [http://69.62.77.6:9999](http://69.62.77.6:9999)

The backend server is hosted on a VPS and running on port **9999**.

---

## âœ¨ Features

### ğŸ” Authentication
- User registration with employee ID
- Secure login with JWT tokens
- Password hashing with bcrypt
- Protected routes with authentication middleware

### â° Attendance Management
- Daily check-in/check-out functionality
- Prevents duplicate check-ins for the same day
- Attendance history with date range filtering
- Automatic status tracking (present, absent, half-day)

### ğŸ–ï¸ Leave Management
- Apply for leave with date range
- Multiple leave types (sick, casual, other)
- Automatic leave approval/rejection via cron job
- Overlap detection to prevent conflicting leave requests
- View leave history and status

### ğŸ“Š Additional Features
- RESTful API architecture
- MongoDB database with Mongoose ODM
- Automated cron jobs for leave processing
- Clean code structure with separation of concerns

---

## ğŸ› ï¸ Tech Stack

### Backend
- **Node.js** - Runtime environment
- **Express.js** - Web framework
- **MongoDB** - NoSQL database
- **Mongoose** - ODM for MongoDB
- **JWT** - Authentication tokens
- **bcrypt** - Password hashing
- **node-cron** - Scheduled tasks
- **dotenv** - Environment variables

### Frontend
- **Flutter** - Cross-platform mobile framework
- **Dart** - Programming language
- **BLoC** - State management (flutter_bloc)
- **HTTP** - API communication
- **Shared Preferences** - Local storage
- **Flutter SVG** - SVG image support

---

## ğŸ“ Project Structure

```
backend+frontend/
â”œâ”€â”€ backend/                    # Node.js/Express Backend
â”‚   â”œâ”€â”€ config/                 # Configuration files
â”‚   â”‚   â””â”€â”€ mongodb.js          # MongoDB connection
â”‚   â”œâ”€â”€ controllers/            # Route controllers
â”‚   â”‚   â”œâ”€â”€ authController.js   # Authentication logic
â”‚   â”‚   â”œâ”€â”€ attendanceController.js
â”‚   â”‚   â””â”€â”€ leaveController.js
â”‚   â”œâ”€â”€ middleware/            # Custom middleware
â”‚   â”‚   â””â”€â”€ authMiddleware.js   # JWT authentication
â”‚   â”œâ”€â”€ models/                 # Mongoose models
â”‚   â”‚   â”œâ”€â”€ user.js
â”‚   â”‚   â”œâ”€â”€ attendance.js
â”‚   â”‚   â””â”€â”€ leave.js
â”‚   â”œâ”€â”€ routes/                 # API routes
â”‚   â”‚   â”œâ”€â”€ authRoutes.js
â”‚   â”‚   â”œâ”€â”€ attendanceRoutes.js
â”‚   â”‚   â””â”€â”€ leaveRoutes.js
â”‚   â”œâ”€â”€ cron/                   # Scheduled tasks
â”‚   â”‚   â””â”€â”€ leaveCron.js        # Leave processing cron
â”‚   â”œâ”€â”€ index.js                # Entry point
â”‚   â””â”€â”€ package.json
â”‚
â””â”€â”€ frontend/                   # Flutter Mobile App
    â”œâ”€â”€ lib/
    â”‚   â”œâ”€â”€ app/                # App configuration
    â”‚   â”œâ”€â”€ core/               # Core utilities
    â”‚   â”œâ”€â”€ features/           # Feature modules
    â”‚   â”‚   â”œâ”€â”€ auth/          # Authentication
    â”‚   â”‚   â”œâ”€â”€ attendance/    # Attendance tracking
    â”‚   â”‚   â”œâ”€â”€ home/          # Home screen
    â”‚   â”‚   â””â”€â”€ leave/         # Leave management
    â”‚   â”œâ”€â”€ theme/             # App theming
    â”‚   â””â”€â”€ widgets/           # Reusable widgets
    â””â”€â”€ pubspec.yaml
```

---

## ğŸš€ Getting Started

### Prerequisites

- **Node.js** (v18 or higher)
- **MongoDB** (v7.0 or higher)
- **Flutter SDK** (v3.6 or higher)
- **npm** or **yarn**

### Backend Setup

1. **Navigate to backend directory**
   ```bash
   cd backend
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Create `.env` file** in the `backend` directory:
   ```env
   PORT=3000
   MONGO_URL=mongodb://localhost:27017/attendance_db
   JWT_SECRET=your_super_secret_jwt_key_here
   JWT_EXPIRY=7d
   ```

4. **Start MongoDB** (if running locally)
   ```bash
   mongod
   ```

5. **Run the server**
   ```bash
   npm start
   ```

   The server will start on `http://localhost:9999`

### Frontend Setup

1. **Navigate to frontend directory**
   ```bash
   cd frontend
   ```

2. **Install dependencies**
   ```bash
   flutter pub get
   ```

3. **Update API configuration** in `lib/core/api_config.dart` with your backend URL

4. **Run the app**
   ```bash
   flutter run
   ```

---

## ğŸ“¡ API Documentation

### Base URL
```
http://69.62.77.6:9999/api
```

**Note:** The server is running on port **9999** on a VPS. For local development, use `http://localhost:9999/api`

### Authentication

All protected routes require a JWT token in the Authorization header:
```
Authorization: Bearer <your_jwt_token>
```

---

### ğŸ”‘ Authentication Routes (`/api/auth`)

#### 1. User Registration
**POST** `/api/auth/signup`

Register a new employee account.

**Request Body:**
```json
{
  "name": "John Doe",
  "email": "john.doe@example.com",
  "password": "securePassword123",
  "employeeId": "EMP001"
}
```

**Response (201):**
```json
{
  "message": "Employee Created Successfully",
  "user": {
    "name": "John Doe",
    "email": "john.doe@example.com",
    "employeeId": "EMP001"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**Error Responses:**
- `400` - Missing required fields or email already exists
- `500` - Internal server error

---

#### 2. User Login
**POST** `/api/auth/login`

Authenticate and get JWT token.

**Request Body:**
```json
{
  "email": "john.doe@example.com",
  "password": "securePassword123"
}
```

**Response (201):**
```json
{
  "message": "Login Successfull",
  "email": "john.doe@example.com",
  "name": "John Doe",
  "employeeId": "EMP001",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**Error Responses:**
- `400` - Missing fields, user not found, or incorrect password
- `500` - Internal server error

---

### â° Attendance Routes (`/api/attendance`)

> **Note:** All attendance routes require authentication.

#### 1. Check In
**POST** `/api/attendance/check-in`

Record daily check-in time.

**Headers:**
```
Authorization: Bearer <token>
```

**Response (201):**
```json
{
  "message": "Checkin Successfull",
  "checkInTime": "2024-01-15T09:00:00.000Z"
}
```

**Error Responses:**
- `400` - Already checked in for the day
- `401` - Unauthorized (invalid/missing token)
- `500` - Internal server error

---

#### 2. Check Out
**POST** `/api/attendance/check-out`

Record daily check-out time.

**Headers:**
```
Authorization: Bearer <token>
```

**Response (201):**
```json
{
  "message": "Checkout successfull",
  "checkOutTime": "2024-01-15T18:00:00.000Z"
}
```

**Error Responses:**
- `400` - No check-in record found or already checked out
- `401` - Unauthorized (invalid/missing token)
- `500` - Internal server error

---

#### 3. Get Attendance Records
**GET** `/api/attendance?from=YYYY-MM-DD&to=YYYY-MM-DD`

Retrieve attendance records for a date range.

**Headers:**
```
Authorization: Bearer <token>
```

**Query Parameters:**
- `from` (required) - Start date (YYYY-MM-DD)
- `to` (required) - End date (YYYY-MM-DD)

**Example:**
```
GET /api/attendance?from=2024-01-01&to=2024-01-31
```

**Response (201):**
```json
{
  "message": "Records fetched successfully",
  "count": 20,
  "records": [
    {
      "_id": "...",
      "employeeId": "...",
      "date": "2024-01-15T00:00:00.000Z",
      "checkInTime": "2024-01-15T09:00:00.000Z",
      "checkOutTime": "2024-01-15T18:00:00.000Z",
      "status": "present"
    }
  ]
}
```

**Error Responses:**
- `400` - Missing from/to date parameters
- `401` - Unauthorized (invalid/missing token)
- `500` - Internal server error

---

### ğŸ–ï¸ Leave Routes (`/api/leave`)

> **Note:** All leave routes require authentication.

#### 1. Apply for Leave
**POST** `/api/leave/apply`

Submit a leave application.

**Headers:**
```
Authorization: Bearer <token>
```

**Request Body:**
```json
{
  "fromDate": "2024-02-01",
  "toDate": "2024-02-03",
  "reason": "Family vacation",
  "type": "casual"
}
```

**Leave Types:**
- `sick` - Sick leave
- `casual` - Casual leave
- `other` - Other leave

**Response (201):**
```json
{
  "message": "Leave applied successfully, wait till 1 minute for response",
  "leave": {
    "_id": "...",
    "employeeId": "...",
    "fromDate": "2024-02-01T00:00:00.000Z",
    "toDate": "2024-02-03T23:59:59.999Z",
    "reason": "Family vacation",
    "type": "casual",
    "status": "pending",
    "appliedDate": "2024-01-20T10:30:00.000Z"
  }
}
```

**Error Responses:**
- `400` - Missing fields, invalid date range, or overlapping leave
- `401` - Unauthorized (invalid/missing token)
- `500` - Internal server error

---

#### 2. Get Leave List
**GET** `/api/leave/list`

Get all leave applications for the authenticated user.

**Headers:**
```
Authorization: Bearer <token>
```

**Response (201):**
```json
{
  "message": "Leaves retrived",
  "count": 5,
  "leaves": [
    {
      "employeeId": "...",
      "fromDate": "2024-02-01T00:00:00.000Z",
      "toDate": "2024-02-03T23:59:59.999Z",
      "reason": "Family vacation",
      "type": "casual",
      "status": "approved",
      "appliedDate": "2024-01-20T10:30:00.000Z"
    }
  ]
}
```

**Leave Status:**
- `pending` - Awaiting approval
- `approved` - Leave approved
- `rejected` - Leave rejected

**Error Responses:**
- `401` - Unauthorized (invalid/missing token)
- `500` - Internal server error

---

## ğŸ”„ Automated Processes

### Leave Processing Cron Job

The system includes an automated cron job (`backend/cron/leaveCron.js`) that processes pending leave applications. The cron job runs periodically and automatically approves or rejects leave requests based on predefined business logic.

**Note:** Leave applications may take up to 1 minute to be processed after submission.

---

## ğŸ—„ï¸ Database Models

### User Model
```javascript
{
  name: String (required),
  email: String (required, unique),
  password: String (hashed, required),
  employeeId: String (required, unique),
  createdAt: Date
}
```

### Attendance Model
```javascript
{
  employeeId: ObjectId (ref: User, required),
  date: Date (required),
  checkInTime: Date,
  checkOutTime: Date,
  status: String (enum: ['present', 'absent', 'half-day'], default: 'present')
}
```

### Leave Model
```javascript
{
  employeeId: ObjectId (ref: User, required),
  fromDate: Date (required),
  toDate: Date (required),
  reason: String (required),
  type: String (enum: ['sick', 'casual', 'other'], required),
  status: String (enum: ['approved', 'rejected', 'pending'], default: 'pending'),
  appliedDate: Date (default: Date.now())
}
```

---

## ğŸ”’ Security Features

- **Password Hashing:** All passwords are hashed using bcrypt before storage
- **JWT Authentication:** Secure token-based authentication
- **Protected Routes:** Middleware ensures only authenticated users can access protected endpoints
- **Input Validation:** Request validation for all endpoints
- **Error Handling:** Comprehensive error handling with appropriate status codes

---

## ğŸ“ Environment Variables

Create a `.env` file in the `backend` directory:

```env
# Server Configuration
PORT=9999

# Database
MONGO_URL=mongodb://localhost:27017/attendance_db

# JWT Configuration
JWT_SECRET=your_super_secret_jwt_key_change_this_in_production
JWT_EXPIRY=7d
```

**Note:** The production server runs on port **9999**.

---

## ğŸ§ª Testing the API

You can test the API using tools like:
- **Postman**
- **Thunder Client** (VS Code extension)
- **curl** commands
- **Insomnia**

### Example curl commands:

**Register:**
```bash
curl -X POST http://69.62.77.6:9999/api/auth/signup \
  -H "Content-Type: application/json" \
  -d '{"name":"John Doe","email":"john@example.com","password":"password123","employeeId":"EMP001"}'
```

**Login:**
```bash
curl -X POST http://69.62.77.6:9999/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"john@example.com","password":"password123"}'
```

**Check In:**
```bash
curl -X POST http://69.62.77.6:9999/api/attendance/check-in \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

---

## ğŸ“± Frontend Features

The Flutter mobile application provides:

- **Authentication Screens:** Login and Signup
- **Home Dashboard:** Overview of attendance and leave status
- **Attendance Tracking:** Check-in/check-out functionality
- **Attendance History:** View past attendance records
- **Leave Management:** Apply for leave and view leave history
- **State Management:** BLoC pattern for clean state management
- **Local Storage:** Token persistence using SharedPreferences

---

## ğŸ¤ Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

---

## ğŸ“„ License

This project is licensed under the ISC License.

---

## ğŸ‘¨â€ğŸ’» Author

**Varun**

**Contact Information:**
- ğŸ“§ Email: varun.kumar.sharma.2365@gmail.com
- ğŸ“± Phone: 8368663536

---

## ğŸ™ Acknowledgments

- Express.js community
- Flutter team
- MongoDB documentation
- All open-source contributors

---

## ğŸ“ Support

For issues, questions, or contributions:
- ğŸ“§ Email: varun.kumar.sharma.2365@gmail.com
- ğŸ“± Phone: 8368663536
- Or open an issue on the GitHub repository

---

**Made with â¤ï¸ using Node.js, Express, MongoDB, and Flutter**

